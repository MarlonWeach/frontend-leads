# Task 28-13: Apontar ausência de implementação em /leads e /configurações, e planejar desenvolvimento dessas páginas

## Status: Done

## Description
Analisar o estado atual das páginas `/leads` e `/settings`, identificar o que está implementado e o que precisa ser desenvolvido, e criar um plano de desenvolvimento para essas funcionalidades.

## Análise do Estado Atual

### Página /leads

#### ✅ **O que está implementado:**
- **Estrutura básica**: Página com layout e navegação
- **Componente LeadsDashboard**: Interface completa com métricas, filtros e lista
- **Hook useLeadsData**: Busca dados da tabela `leads` do Supabase
- **Funcionalidades de UI**:
  - Cards de métricas coloridos (Total, Novos, Convertidos, Esta Semana)
  - Filtros por status, busca e período
  - Lista de leads com detalhes
  - Modal de detalhes do lead
  - Ações de status (Contatado, Qualificado, Convertido)
  - Integração com email e WhatsApp
- **Métricas calculadas**: Total, novos, contactados, qualificados, convertidos, taxa de conversão
- **Exportação CSV**: Funcionalidade implementada no hook

#### ❌ **O que precisa ser desenvolvido:**
1. **Tabela `leads` no Supabase**: Não existe, precisa ser criada
2. **API de leads**: Endpoint para buscar e gerenciar leads
3. **Integração com Meta API**: Buscar leads reais da Meta
4. **Funcionalidades de backend**:
   - Atualização de status de leads
   - Adição de interações
   - Sistema de pontuação de qualidade
   - Exportação real de dados

### Página /settings

#### ✅ **O que está implementado:**
- **Estrutura básica**: Página com layout e navegação
- **Interface de sincronização**: Botão e status de sincronização
- **Status de conexão**: Indicador visual de conectividade
- **UI responsiva**: Design consistente com o resto da aplicação

#### ❌ **O que precisa ser desenvolvido:**
1. **Funcionalidade real de sincronização**: Atualmente é simulação
2. **Configurações de API**: Tokens, configurações da Meta
3. **Configurações de notificações**: Alertas e emails
4. **Configurações de usuário**: Perfil, preferências
5. **Configurações de exportação**: Formatos, agendamento
6. **Logs de sistema**: Histórico de sincronizações e erros

## Plano de Desenvolvimento

### Fase 1: Infraestrutura de Leads (Prioridade Alta)

#### 1.1 Criar Tabela `leads` no Supabase
```sql
-- Tabela principal de leads
CREATE TABLE leads (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  lead_id VARCHAR UNIQUE, -- ID da Meta API
  full_name VARCHAR,
  email VARCHAR,
  phone VARCHAR,
  status VARCHAR DEFAULT 'new', -- new, contacted, qualified, converted, unqualified
  campaign_id VARCHAR,
  adset_id VARCHAR,
  ad_id VARCHAR,
  form_data JSONB, -- Dados do formulário da Meta
  quality_score INTEGER DEFAULT 0, -- 1-5 estrelas
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  contacted_at TIMESTAMP WITH TIME ZONE,
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Tabela de interações com leads
CREATE TABLE lead_interactions (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  lead_id UUID REFERENCES leads(id) ON DELETE CASCADE,
  interaction_type VARCHAR, -- call, email, whatsapp, note
  title VARCHAR,
  description TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  completed_at TIMESTAMP WITH TIME ZONE
);

-- Índices para performance
CREATE INDEX idx_leads_status ON leads(status);
CREATE INDEX idx_leads_campaign ON leads(campaign_id);
CREATE INDEX idx_leads_created_at ON leads(created_at);
CREATE INDEX idx_lead_interactions_lead_id ON lead_interactions(lead_id);
```

#### 1.2 API de Leads
```typescript
// app/api/leads/route.ts
export async function GET(request: NextRequest) {
  // Buscar leads com filtros
}

export async function POST(request: NextRequest) {
  // Criar novo lead
}

// app/api/leads/[id]/route.ts
export async function PUT(request: NextRequest, { params }) {
  // Atualizar lead
}

export async function DELETE(request: NextRequest, { params }) {
  // Excluir lead
}
```

#### 1.3 Integração com Meta API
```typescript
// scripts/sync-meta-leads.js
// Sincronizar leads da Meta API para Supabase
```

### Fase 2: Funcionalidades de Configurações (Prioridade Média)

#### 2.1 Configurações de API
- Interface para configurar tokens da Meta
- Validação de conectividade
- Configurações de rate limiting

#### 2.2 Configurações de Sincronização
- Agendamento de sincronizações
- Configuração de frequência
- Logs de sincronização

#### 2.3 Configurações de Notificações
- Alertas de novos leads
- Notificações de erros
- Configuração de emails

### Fase 3: Melhorias e Otimizações (Prioridade Baixa)

#### 3.1 Sistema de Pontuação de Qualidade
- Algoritmo de scoring baseado em dados
- Configuração de critérios
- Relatórios de qualidade

#### 3.2 Funcionalidades Avançadas
- Automação de follow-up
- Integração com CRM
- Relatórios avançados

## Estimativa de Desenvolvimento

### Fase 1: Infraestrutura de Leads
- **Tempo estimado**: 2-3 semanas
- **Esforço**: Alto
- **Dependências**: Meta API, Supabase

### Fase 2: Configurações
- **Tempo estimado**: 1-2 semanas
- **Esforço**: Médio
- **Dependências**: Fase 1

### Fase 3: Melhorias
- **Tempo estimado**: 2-3 semanas
- **Esforço**: Médio
- **Dependências**: Fases 1 e 2

## Recomendações

### Prioridade Imediata
1. **Criar tabela `leads`** no Supabase
2. **Implementar API de leads** básica
3. **Integrar com Meta API** para buscar leads reais
4. **Testar funcionalidades** existentes com dados reais

### Próximos Passos
1. **Definir estrutura** da tabela `leads`
2. **Criar migração** do Supabase
3. **Implementar API** de leads
4. **Testar integração** com Meta API
5. **Validar funcionalidades** da interface

## Conclusão

As páginas `/leads` e `/settings` têm uma **interface bem implementada** mas precisam de **desenvolvimento do backend** para serem funcionais. A prioridade deve ser criar a infraestrutura de dados e APIs para que as funcionalidades existentes possam trabalhar com dados reais.

### Status Atual
- **Interface**: ✅ 90% implementada
- **Backend**: ❌ 10% implementado
- **Integração**: ❌ 0% implementada

### Próximo Passo Recomendado
Criar a tabela `leads` no Supabase e implementar a API básica para que a página de leads possa funcionar com dados reais. 