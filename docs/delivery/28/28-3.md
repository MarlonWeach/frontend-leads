# 28-3 Corrigir formatação de valores de spend nos gráficos

## Description
Padronizar a formatação de valores monetários (R$) em todos os gráficos do dashboard, garantindo que valores de gasto sejam exibidos corretamente como moeda brasileira com 2 casas decimais.

## Status History
| Timestamp           | Event Type     | From Status | To Status | Details                                 | User   |
|---------------------|---------------|-------------|-----------|-----------------------------------------|--------|
| 2025-01-22 10:00:00 | Created       | N/A         | Proposed  | Task file criada e status inicial definido | assistente |
| 2025-01-22 10:15:00 | Status Update | Proposed    | InProgress | Iniciando correção da formatação de moeda | assistente |
| 2025-01-22 10:45:00 | Status Update | InProgress  | Done      | Formatação de moeda implementada em todos os gráficos | assistente |

## Status: Done

## Requirements
- ✅ Formatar valores de gasto como R$ nos gráficos de barras
- ✅ Formatar valores de gasto como R$ nos gráficos de pizza
- ✅ Formatar valores de gasto como R$ nos gráficos de linha
- ✅ Aplicar formatação no eixo Y dos gráficos de barras
- ✅ Aplicar formatação nos tooltips de todos os gráficos
- ✅ Detectar automaticamente chaves relacionadas a gasto (spend, gasto, gastos)

## Implementation Plan
1. **✅ Identificar componentes de gráficos**:
   - AnimatedBarChart
   - AnimatedPieChart
   - AnimatedLineChart

2. **✅ Implementar função de detecção de gasto**:
   - Criar função `isSpendKey()` para detectar chaves de gasto
   - Suportar variações: 'spend', 'gasto', 'gastos'

3. **✅ Aplicar formatação no AnimatedBarChart**:
   - Formatar eixo Y quando chave for de gasto
   - Formatar tooltip quando chave for de gasto

4. **✅ Aplicar formatação no AnimatedPieChart**:
   - Formatar tooltip quando dados forem de gasto
   - Detectar por id ou label da série

5. **✅ Aplicar formatação no AnimatedLineChart**:
   - Formatar tooltip quando série for de gasto
   - Detectar por serieId

## Implementation Details

### AnimatedBarChart.jsx
- Adicionada função `isSpendKey()` para detectar chaves de gasto
- Aplicada formatação `formatCurrency` no eixo Y quando `isSpendKey(keys[0])` retorna true
- Aplicada formatação `formatCurrency` no tooltip quando `isSpendKey(id)` retorna true

### AnimatedPieChart.jsx
- Melhorada detecção de dados de gasto no tooltip
- Suporte para variações: 'spend', 'gasto', 'gastos' em id e label
- Aplicada formatação `formatCurrency` quando dados são de gasto

### AnimatedLineChart.jsx
- Adicionada função `isSpendSeries()` para detectar séries de gasto
- Adicionada função `formatCurrency()` para formatação monetária
- Aplicada formatação `formatCurrency` no tooltip quando série é de gasto

### Função formatCurrency
```javascript
function formatCurrency(value) {
  return new Intl.NumberFormat('pt-BR', {
    style: 'currency',
    currency: 'BRL',
    minimumFractionDigits: 2,
    maximumFractionDigits: 2
  }).format(value || 0);
}
```

## Verification
- [x] Gráfico "Gastos por Campanha (Top 10)" na página `/performance` exibe valores como R$ no eixo Y
- [x] Tooltips dos gráficos de barras formatam valores de gasto como R$
- [x] Tooltips dos gráficos de pizza formatam valores de gasto como R$
- [x] Tooltips dos gráficos de linha formatam valores de gasto como R$
- [x] Detecção automática funciona para chaves 'spend', 'gasto', 'gastos'
- [x] Formatação mantém 2 casas decimais para valores monetários

## Files Modified
- `src/components/ui/AnimatedBarChart.jsx` - Adicionada formatação de moeda no eixo Y e tooltip
- `src/components/ui/AnimatedPieChart.jsx` - Melhorada detecção e formatação de gasto no tooltip
- `src/components/ui/AnimatedLineChart.jsx` - Adicionada formatação de moeda no tooltip

## Test Plan
1. **Teste de formatação no eixo Y**:
   - Acessar página `/performance`
   - Verificar se valores no eixo Y do gráfico "Gastos por Campanha" aparecem como R$ X,XX

2. **Teste de formatação nos tooltips**:
   - Passar mouse sobre barras do gráfico de gastos
   - Verificar se tooltip exibe valores como R$ X,XX
   - Testar em gráficos de pizza e linha

3. **Teste de detecção automática**:
   - Verificar se funciona com chaves 'spend', 'gasto', 'gastos'
   - Confirmar que outras métricas não são formatadas como moeda

## Notes
- A formatação é aplicada automaticamente baseada na detecção de chaves relacionadas a gasto
- Valores não relacionados a gasto continuam usando `formatNumberShort` para abreviação
- Formatação segue padrão brasileiro (R$ com vírgula decimal e ponto para milhares) 